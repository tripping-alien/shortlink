<div class="footer">
    <div class="container text-center">
        <p class="mb-3">
            Â© {{ current_year }} Shortlinks.art 
            <a href="{{ url_for('localized', locale=locale, path='') }}">{{ _('nav_home') }}</a>
            <a href="{{ url_for('localized', locale=locale, path='about') }}">{{ _('nav_about') }}</a>
        </p>
        
        <div class="language-switcher">
            {% for lang_code in config.SUPPORTED_LOCALES %}
                {% set flag = FLAG_EMOJIS.get(lang_code) %}
                
                {# 
                   1. Get the current path without the locale prefix (e.g., /en/about -> /about)
                   2. CRITICAL FIX: Use .lstrip('/') to remove the leading slash, 
                      which is required when passing the path argument to url_for.
                #}
                {% set current_path_no_locale = request.url.path.replace('/' + locale, '', 1) or '/' %}
                
                {% set new_path = url_for('localized', locale=lang_code, path=current_path_no_locale.lstrip('/')) %}
                
                <a href="{{ new_path }}"
                   class="lang-link {% if lang_code == locale %}active{% endif %}"
                   style="opacity: {% if lang_code == locale %}1.0{% else %}0.5{% endif %}; margin: 0 4px; font-size: 1.5rem; text-decoration: none; transition: opacity 0.2s;"
                   aria-label="Switch to {{ lang_code|upper }}"
                   title="{{ lang_code|upper }}">
                    {{ flag }}
                </a>
            {% endfor %}
        </div>
        </div>
</div>
